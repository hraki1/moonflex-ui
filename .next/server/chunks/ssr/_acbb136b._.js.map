{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/src/lib/actions/SignupAction.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport connectToDB from \"../dbConnect\";\r\nimport User from \"../models/User\";\r\nimport bcrypt from \"bcrypt\";\r\nimport jwt from \"jsonwebtoken\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET as string;\r\n\r\ntype CreateUserResult = {\r\n  message: string[];\r\n  user?: {\r\n    name: string;\r\n    email: string;\r\n    password: string;\r\n  };\r\n  success?: boolean;\r\n};\r\n\r\nexport const signupAction = async (\r\n  prevState: CreateUserResult,\r\n  formData: FormData\r\n): Promise<CreateUserResult> => {\r\n  const name = formData.get(\"name\") as string;\r\n  const email = formData.get(\"email\") as string;\r\n  const password = formData.get(\"password\") as string;\r\n\r\n  console.log(name, email, password);\r\n  const errors: string[] = [];\r\n\r\n  if (!name || name.trim() === \"\") errors.push(\"Name is required\");\r\n  if (!email || !email.includes(\"@\")) errors.push(\"Valid email is required\");\r\n  if (!password || password.length < 6)\r\n    errors.push(\"Password must be at least 6 characters\");\r\n\r\n  if (errors.length > 0) return { message: errors };\r\n\r\n  await connectToDB();\r\n\r\n  const existingUser = await User.findOne({ email });\r\n  if (existingUser) return { message: [\"Email already in use\"] };\r\n\r\n  const hashedPassword = await bcrypt.hash(password, 10);\r\n\r\n  const newUser = await User.create({\r\n    name,\r\n    email,\r\n    password: hashedPassword,\r\n  });\r\n\r\n  // إنشاء التوكن\r\n  const token = jwt.sign(\r\n    { id: newUser._id, email: newUser.email },\r\n    JWT_SECRET,\r\n    { expiresIn: \"7d\" }\r\n  );\r\n\r\n  // تخزينه في الكوكيز\r\n  (\r\n    await // تخزينه في الكوكيز\r\n    cookies()\r\n  ).set(\"token\", token, {\r\n    httpOnly: true,\r\n    path: \"/\",\r\n    maxAge: 60 * 60 * 24 * 7,\r\n  });\r\n\r\n  // إعادة التوجيه\r\n  redirect(\"/\");\r\n\r\n  return {\r\n    message: [],\r\n    user: {\r\n      name,\r\n      email,\r\n      password,\r\n    },\r\n    success: true,\r\n  };\r\n};\r\nfunction redirect(arg0: string) {\r\n  throw new Error(\"Function not implemented.\");\r\n}\r\n"],"names":[],"mappings":";;;;;;IAoBa,eAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/src/app/auth/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useActionState } from \"react\";\r\nimport { signupAction } from \"@/lib/actions/SignupAction\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { useEffect } from \"react\";\r\n\r\nconst AuthPage = () => {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const mode = searchParams.get(\"mode\");\r\n\r\n  const [formState, formAction, isLoading] = useActionState(signupAction, {\r\n    message: [],\r\n    user: {\r\n      name: \"\",\r\n      email: \"\",\r\n      password: \"\",\r\n    },\r\n    success: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (formState.success) {\r\n      router.push(\"/\");\r\n    }\r\n  }, [formState, router]);\r\n\r\n  function toggleMode() {\r\n    if (mode === \"login\") {\r\n      router.push(\"/auth?mode=signup\");\r\n    } else {\r\n      router.push(\"/auth?mode=login\");\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"relative flex h-screen flex-col bg-black md:mt-[120px] md:items-center md:bg-transparent\">\r\n      <form\r\n        action={formAction}\r\n        className=\"relative mt-24 space-y-6 rounded bg-black/75 py-8 px-6 md:mt-0 md:max-w-md md:px-14\"\r\n      >\r\n        <h1 className=\"text-3xl font-semibold text-white text-center\">\r\n          {mode === \"login\" ? \"Sign In\" : \"Create Account\"}\r\n        </h1>\r\n\r\n        {formState.message && formState.message.length > 0 && (\r\n          <div className=\"p-3 bg-red-600 text-white rounded text-sm\">\r\n            <ul>\r\n              {formState.message.map((ms, index) => (\r\n                <li key={index}>{ms}</li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"space-y-4\">\r\n          {mode === \"signup\" && (\r\n            <label className=\"inline-block w-full\">\r\n              <input\r\n                name=\"name\"\r\n                type=\"text\"\r\n                placeholder=\"Name\"\r\n                defaultValue={formState.user?.name}\r\n                className=\"input\"\r\n                disabled={isLoading}\r\n              />\r\n            </label>\r\n          )}\r\n\r\n          <label className=\"inline-block w-full\">\r\n            <input\r\n              name=\"email\"\r\n              type=\"email\"\r\n              placeholder=\"Email\"\r\n              defaultValue={formState.user?.email}\r\n              className=\"input\"\r\n              required\r\n              disabled={isLoading}\r\n            />\r\n          </label>\r\n\r\n          <label className=\"inline-block w-full\">\r\n            <input\r\n              name=\"password\"\r\n              type=\"password\"\r\n              placeholder=\"Password\"\r\n              defaultValue={formState.user?.password}\r\n              className=\"input\"\r\n              required\r\n              disabled={isLoading}\r\n            />\r\n          </label>\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          disabled={isLoading}\r\n          className={`w-full rounded bg-[#e50914] py-3 font-semibold ${\r\n            isLoading ? \"opacity-60 cursor-not-allowed\" : \"\"\r\n          }`}\r\n        >\r\n          {isLoading\r\n            ? mode === \"login\"\r\n              ? \"Signing In...\"\r\n              : \"Signing Up...\"\r\n            : mode === \"login\"\r\n            ? \"Sign In\"\r\n            : \"Sign Up\"}\r\n        </button>\r\n\r\n        <div className=\"flex justify-between items-center text-[#737373] text-sm\">\r\n          <div className=\"flex items-center\">\r\n            <input\r\n              type=\"checkbox\"\r\n              id=\"remember\"\r\n              className=\"mr-1\"\r\n              disabled={isLoading}\r\n            />\r\n            <label htmlFor=\"remember\">Remember me</label>\r\n          </div>\r\n          <a href=\"#\" className=\"hover:underline\">\r\n            Need help?\r\n          </a>\r\n        </div>\r\n\r\n        <div className=\"text-[#737373]\">\r\n          {mode === \"login\" ? (\r\n            <>\r\n              New to Netflix?{\" \"}\r\n              <button\r\n                type=\"button\"\r\n                onClick={toggleMode}\r\n                className=\"text-white hover:underline\"\r\n                disabled={isLoading}\r\n              >\r\n                Sign up now\r\n              </button>\r\n            </>\r\n          ) : (\r\n            <>\r\n              Already have an account?{\" \"}\r\n              <button\r\n                type=\"button\"\r\n                onClick={toggleMode}\r\n                className=\"text-white hover:underline\"\r\n                disabled={isLoading}\r\n              >\r\n                Sign in now\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"text-[#737373] text-xs\">\r\n          <p>\r\n            This page is protected by Google reCAPTCHA to ensure you&#39;re not\r\n            a bot.{\" \"}\r\n            <a href=\"#\" className=\"text-blue-500 hover:underline\">\r\n              Learn more.\r\n            </a>\r\n          </p>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AuthPage;\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AAHA;;;;;;AAMA,MAAM,WAAW;IACf,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,eAAe,CAAA,GAAA,kIAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,OAAO,aAAa,GAAG,CAAC;IAE9B,MAAM,CAAC,WAAW,YAAY,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,iBAAc,AAAD,EAAE,6JAAA,CAAA,eAAY,EAAE;QACtE,SAAS,EAAE;QACX,MAAM;YACJ,MAAM;YACN,OAAO;YACP,UAAU;QACZ;QACA,SAAS;IACX;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,UAAU,OAAO,EAAE;YACrB,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;QAAW;KAAO;IAEtB,SAAS;QACP,IAAI,SAAS,SAAS;YACpB,OAAO,IAAI,CAAC;QACd,OAAO;YACL,OAAO,IAAI,CAAC;QACd;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YACC,QAAQ;YACR,WAAU;;8BAEV,8OAAC;oBAAG,WAAU;8BACX,SAAS,UAAU,YAAY;;;;;;gBAGjC,UAAU,OAAO,IAAI,UAAU,OAAO,CAAC,MAAM,GAAG,mBAC/C,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;kCACE,UAAU,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,sBAC1B,8OAAC;0CAAgB;+BAAR;;;;;;;;;;;;;;;8BAMjB,8OAAC;oBAAI,WAAU;;wBACZ,SAAS,0BACR,8OAAC;4BAAM,WAAU;sCACf,cAAA,8OAAC;gCACC,MAAK;gCACL,MAAK;gCACL,aAAY;gCACZ,cAAc,UAAU,IAAI,EAAE;gCAC9B,WAAU;gCACV,UAAU;;;;;;;;;;;sCAKhB,8OAAC;4BAAM,WAAU;sCACf,cAAA,8OAAC;gCACC,MAAK;gCACL,MAAK;gCACL,aAAY;gCACZ,cAAc,UAAU,IAAI,EAAE;gCAC9B,WAAU;gCACV,QAAQ;gCACR,UAAU;;;;;;;;;;;sCAId,8OAAC;4BAAM,WAAU;sCACf,cAAA,8OAAC;gCACC,MAAK;gCACL,MAAK;gCACL,aAAY;gCACZ,cAAc,UAAU,IAAI,EAAE;gCAC9B,WAAU;gCACV,QAAQ;gCACR,UAAU;;;;;;;;;;;;;;;;;8BAKhB,8OAAC;oBACC,MAAK;oBACL,UAAU;oBACV,WAAW,CAAC,+CAA+C,EACzD,YAAY,kCAAkC,IAC9C;8BAED,YACG,SAAS,UACP,kBACA,kBACF,SAAS,UACT,YACA;;;;;;8BAGN,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,MAAK;oCACL,IAAG;oCACH,WAAU;oCACV,UAAU;;;;;;8CAEZ,8OAAC;oCAAM,SAAQ;8CAAW;;;;;;;;;;;;sCAE5B,8OAAC;4BAAE,MAAK;4BAAI,WAAU;sCAAkB;;;;;;;;;;;;8BAK1C,8OAAC;oBAAI,WAAU;8BACZ,SAAS,wBACR;;4BAAE;4BACgB;0CAChB,8OAAC;gCACC,MAAK;gCACL,SAAS;gCACT,WAAU;gCACV,UAAU;0CACX;;;;;;;qDAKH;;4BAAE;4BACyB;0CACzB,8OAAC;gCACC,MAAK;gCACL,SAAS;gCACT,WAAU;gCACV,UAAU;0CACX;;;;;;;;;;;;;8BAOP,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;;4BAAE;4BAEM;0CACP,8OAAC;gCAAE,MAAK;gCAAI,WAAU;0CAAgC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQlE;uCAEe","debugId":null}},
    {"offset": {"line": 302, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-client-wrapper.ts"],"sourcesContent":["// This file must be bundled in the app's client layer, it shouldn't be directly\n// imported by the server.\n\nexport { callServer } from 'next/dist/client/app-call-server'\nexport { findSourceMapURL } from 'next/dist/client/app-find-source-map-url'\n\n// A noop wrapper to let the Flight client create the server reference.\n// See also: https://github.com/facebook/react/pull/26632\n// Since we're using the Edge build of Flight client for SSR [1], here we need to\n// also use the same Edge build to create the reference. For the client bundle,\n// we use the default and let Webpack to resolve it to the correct version.\n// 1: https://github.com/vercel/next.js/blob/16eb80b0b0be13f04a6407943664b5efd8f3d7d0/packages/next/src/server/app-render/use-flight-response.tsx#L24-L26\nexport const createServerReference = (\n  (!!process.env.NEXT_RUNTIME\n    ? // eslint-disable-next-line import/no-extraneous-dependencies\n      require('react-server-dom-webpack/client.edge')\n    : // eslint-disable-next-line import/no-extraneous-dependencies\n      require('react-server-dom-webpack/client')) as typeof import('react-server-dom-webpack/client')\n).createServerReference\n"],"names":["callServer","createServerReference","findSourceMapURL","process","env","NEXT_RUNTIME","require"],"mappings":"AAAA,gFAAgF;AAChF,0BAA0B;;;;;;;;;;;;;;;;;IAEjBA,UAAU,EAAA;eAAVA,eAAAA,UAAU;;IASNC,qBAAqB,EAAA;eAArBA;;IARJC,gBAAgB,EAAA;eAAhBA,qBAAAA,gBAAgB;;;+BADE;qCACM;AAQ1B,MAAMD,wBACV,CAAA,CAAC,CAACE,QAAQC,GAAG,CAACC,YAAY,GAEvBC,QAAQ,0CAERA,QAAQ,8JAAiC,EAC7CL,qBAAqB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 338, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}