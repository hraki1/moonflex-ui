{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/src/lib/dbConnect.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI;\r\n\r\nconst connectToDB = async () => {\r\n  if (!MONGODB_URI) {\r\n    throw new Error(\"Missing MONGODB_URI in environment variables\");\r\n  }\r\n\r\n  // إذا تم الاتصال مسبقاً، لا تعيد الاتصال\r\n  if (mongoose.connections[0].readyState) return;\r\n\r\n  try {\r\n    await mongoose.connect(MONGODB_URI, {\r\n      dbName: \"moonflex\", // غيرها حسب اسم قاعدة بياناتك\r\n    });\r\n\r\n    console.log(\"✅ MongoDB connected\");\r\n  } catch (error) {\r\n    console.error(\"❌ MongoDB connection error:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport default connectToDB;\r\n"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,MAAM,cAAc;IAClB,IAAI,CAAC,aAAa;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,yCAAyC;IACzC,IAAI,yGAAA,CAAA,UAAQ,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE;IAExC,IAAI;QACF,MAAM,yGAAA,CAAA,UAAQ,CAAC,OAAO,CAAC,aAAa;YAClC,QAAQ;QACV;QAEA,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,MAAM;IACR;AACF;uCAEe","debugId":null}},
    {"offset": {"line": 44, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/src/lib/models/User.ts"],"sourcesContent":["import mongoose, { Schema, Document } from \"mongoose\";\r\n\r\nexport interface IUser extends Document {\r\n  name: string;\r\n  email: string;\r\n  password: string;\r\n  favoriteFilms: string[];\r\n}\r\n\r\nconst UserSchema = new Schema<IUser>(\r\n  {\r\n    name: { type: String, required: true },\r\n    email: { type: String, required: true, unique: true },\r\n    password: { type: String, required: true },\r\n    favoriteFilms: [{ type: String }],\r\n  },\r\n  {\r\n    timestamps: true,\r\n  }\r\n);\r\n\r\nconst User = mongoose.models.User || mongoose.model<IUser>(\"User\", UserSchema);\r\n\r\nexport default User;\r\n"],"names":[],"mappings":";;;AAAA;;AASA,MAAM,aAAa,IAAI,yGAAA,CAAA,SAAM,CAC3B;IACE,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAK;IACrC,OAAO;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;IAAK;IACpD,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;IACzC,eAAe;QAAC;YAAE,MAAM;QAAO;KAAE;AACnC,GACA;IACE,YAAY;AACd;AAGF,MAAM,OAAO,yGAAA,CAAA,UAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,yGAAA,CAAA,UAAQ,CAAC,KAAK,CAAQ,QAAQ;uCAEpD","debugId":null}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/src/lib/actions/SignupAction.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport connectToDB from \"../dbConnect\";\r\nimport User from \"../models/User\";\r\nimport bcrypt from \"bcrypt\";\r\nimport jwt from \"jsonwebtoken\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET as string;\r\n\r\ntype CreateUserResult = {\r\n  message: string[];\r\n  user?: {\r\n    name: string;\r\n    email: string;\r\n    password?: string;\r\n  };\r\n  success?: boolean;\r\n};\r\n\r\nexport const signupAction = async (\r\n  prevState: CreateUserResult,\r\n  formData: FormData\r\n): Promise<CreateUserResult> => {\r\n  const name = formData.get(\"name\") as string;\r\n  const email = formData.get(\"email\") as string;\r\n  const password = formData.get(\"password\") as string;\r\n\r\n  const errors: string[] = [];\r\n\r\n  if (!name || name.trim() === \"\") errors.push(\"Name is required\");\r\n  if (!email || !email.includes(\"@\")) errors.push(\"Valid email is required\");\r\n  if (!password || password.length < 6)\r\n    errors.push(\"Password must be at least 6 characters\");\r\n\r\n  if (errors.length > 0) return { message: errors };\r\n\r\n  await connectToDB();\r\n\r\n  const existingUser = await User.findOne({ email });\r\n  if (existingUser) return { message: [\"Email already in use\"] };\r\n\r\n  const hashedPassword = await bcrypt.hash(password, 10);\r\n\r\n  const newUser = await User.create({\r\n    name,\r\n    email,\r\n    password: hashedPassword,\r\n  });\r\n\r\n  const token = jwt.sign(\r\n    { id: newUser._id, email: newUser.email },\r\n    JWT_SECRET,\r\n    { expiresIn: \"7d\" }\r\n  );\r\n\r\n  // Fixed cookie setting\r\n  const cookieStore = await cookies();\r\n  cookieStore.set(\"token\", token, {\r\n    httpOnly: true,\r\n    path: \"/\",\r\n    maxAge: 60 * 60 * 24 * 7,\r\n  });\r\n\r\n  return {\r\n    message: [],\r\n    user: {\r\n      name,\r\n      email,\r\n    },\r\n    success: true,\r\n  };\r\n};\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AAYlC,MAAM,eAAe,OAC1B,WACA;IAEA,MAAM,OAAO,SAAS,GAAG,CAAC;IAC1B,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;IAE9B,MAAM,SAAmB,EAAE;IAE3B,IAAI,CAAC,QAAQ,KAAK,IAAI,OAAO,IAAI,OAAO,IAAI,CAAC;IAC7C,IAAI,CAAC,SAAS,CAAC,MAAM,QAAQ,CAAC,MAAM,OAAO,IAAI,CAAC;IAChD,IAAI,CAAC,YAAY,SAAS,MAAM,GAAG,GACjC,OAAO,IAAI,CAAC;IAEd,IAAI,OAAO,MAAM,GAAG,GAAG,OAAO;QAAE,SAAS;IAAO;IAEhD,MAAM,CAAA,GAAA,uHAAA,CAAA,UAAW,AAAD;IAEhB,MAAM,eAAe,MAAM,4HAAA,CAAA,UAAI,CAAC,OAAO,CAAC;QAAE;IAAM;IAChD,IAAI,cAAc,OAAO;QAAE,SAAS;YAAC;SAAuB;IAAC;IAE7D,MAAM,iBAAiB,MAAM,qGAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU;IAEnD,MAAM,UAAU,MAAM,4HAAA,CAAA,UAAI,CAAC,MAAM,CAAC;QAChC;QACA;QACA,UAAU;IACZ;IAEA,MAAM,QAAQ,qIAAA,CAAA,UAAG,CAAC,IAAI,CACpB;QAAE,IAAI,QAAQ,GAAG;QAAE,OAAO,QAAQ,KAAK;IAAC,GACxC,YACA;QAAE,WAAW;IAAK;IAGpB,uBAAuB;IACvB,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;IAChC,YAAY,GAAG,CAAC,SAAS,OAAO;QAC9B,UAAU;QACV,MAAM;QACN,QAAQ,KAAK,KAAK,KAAK;IACzB;IAEA,OAAO;QACL,SAAS,EAAE;QACX,MAAM;YACJ;YACA;QACF;QACA,SAAS;IACX;AACF;;;IApDa;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 197, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/src/lib/actions/LoginAction.tsx"],"sourcesContent":["\"use server\";\r\n\r\nimport connectToDB from \"../dbConnect\";\r\nimport User from \"../models/User\";\r\nimport bcrypt from \"bcrypt\";\r\nimport jwt from \"jsonwebtoken\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET as string;\r\n\r\ntype LoginResult = {\r\n  message: string[];\r\n  user?: {\r\n    name: string;\r\n    email: string;\r\n    password?: string;\r\n  };\r\n  success?: boolean;\r\n};\r\n\r\nexport const loginAction = async (\r\n  prevState: LoginResult,\r\n  formData: FormData\r\n): Promise<LoginResult> => {\r\n  const email = formData.get(\"email\") as string;\r\n  const password = formData.get(\"password\") as string;\r\n\r\n  const errors: string[] = [];\r\n\r\n  // التحقق من صحة المدخلات\r\n  if (!email || !email.includes(\"@\")) errors.push(\"البريد الإلكتروني غير صالح\");\r\n  if (!password || password.length < 6)\r\n    errors.push(\"كلمة المرور يجب أن تكون 6 أحرف على الأقل\");\r\n\r\n  if (errors.length > 0) return { message: errors };\r\n\r\n  await connectToDB();\r\n\r\n  try {\r\n    // البحث عن المستخدم في قاعدة البيانات\r\n    const user = await User.findOne({ email });\r\n\r\n    // إذا لم يتم العثور على المستخدم\r\n    if (!user) {\r\n      return { message: [\"Email is not used try to create new account\"] };\r\n    }\r\n\r\n    // مقارنة كلمة المرور مع الهاش المخزن\r\n    const isPasswordValid = await bcrypt.compare(password, user.password);\r\n\r\n    // إذا كانت كلمة المرور غير صحيحة\r\n    if (!isPasswordValid) {\r\n      return { message: [\"Password not correct\"] };\r\n    }\r\n\r\n    // إنشاء توكن جديد\r\n    const token = jwt.sign({ id: user._id, email: user.email }, JWT_SECRET, {\r\n      expiresIn: \"7d\",\r\n    });\r\n\r\n    // تخزين التوكن في الكوكيز\r\n    const cookieStore = await cookies();\r\n    cookieStore.set(\"token\", token, {\r\n      httpOnly: true,\r\n      path: \"/\",\r\n      maxAge: 60 * 60 * 24 * 7,\r\n    });\r\n\r\n    // إرجاع بيانات المستخدم (بدون كلمة المرور)\r\n    return {\r\n      message: [],\r\n      user: {\r\n        name: user.name,\r\n        email: user.email,\r\n      },\r\n      success: true,\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Login error:\", error);\r\n    return { message: [\"حدث خطأ أثناء محاولة تسجيل الدخول\"] };\r\n  }\r\n};\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AAYlC,MAAM,cAAc,OACzB,WACA;IAEA,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;IAE9B,MAAM,SAAmB,EAAE;IAE3B,yBAAyB;IACzB,IAAI,CAAC,SAAS,CAAC,MAAM,QAAQ,CAAC,MAAM,OAAO,IAAI,CAAC;IAChD,IAAI,CAAC,YAAY,SAAS,MAAM,GAAG,GACjC,OAAO,IAAI,CAAC;IAEd,IAAI,OAAO,MAAM,GAAG,GAAG,OAAO;QAAE,SAAS;IAAO;IAEhD,MAAM,CAAA,GAAA,uHAAA,CAAA,UAAW,AAAD;IAEhB,IAAI;QACF,sCAAsC;QACtC,MAAM,OAAO,MAAM,4HAAA,CAAA,UAAI,CAAC,OAAO,CAAC;YAAE;QAAM;QAExC,iCAAiC;QACjC,IAAI,CAAC,MAAM;YACT,OAAO;gBAAE,SAAS;oBAAC;iBAA8C;YAAC;QACpE;QAEA,qCAAqC;QACrC,MAAM,kBAAkB,MAAM,qGAAA,CAAA,UAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;QAEpE,iCAAiC;QACjC,IAAI,CAAC,iBAAiB;YACpB,OAAO;gBAAE,SAAS;oBAAC;iBAAuB;YAAC;QAC7C;QAEA,kBAAkB;QAClB,MAAM,QAAQ,qIAAA,CAAA,UAAG,CAAC,IAAI,CAAC;YAAE,IAAI,KAAK,GAAG;YAAE,OAAO,KAAK,KAAK;QAAC,GAAG,YAAY;YACtE,WAAW;QACb;QAEA,0BAA0B;QAC1B,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;QAChC,YAAY,GAAG,CAAC,SAAS,OAAO;YAC9B,UAAU;YACV,MAAM;YACN,QAAQ,KAAK,KAAK,KAAK;QACzB;QAEA,2CAA2C;QAC3C,OAAO;YACL,SAAS,EAAE;YACX,MAAM;gBACJ,MAAM,KAAK,IAAI;gBACf,OAAO,KAAK,KAAK;YACnB;YACA,SAAS;QACX;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO;YAAE,SAAS;gBAAC;aAAoC;QAAC;IAC1D;AACF;;;IA7Da;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 293, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/.next-internal/server/app/auth/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {signupAction as '7f951f619351a3a56e682e1cf6e502a59dd1b3162c'} from 'ACTIONS_MODULE0'\nexport {loginAction as '7fb5f85efbf27ef05613227a0bc5313a7c7b8efec0'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AACA","debugId":null}},
    {"offset": {"line": 345, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/src/app/auth/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/auth/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/auth/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAyR,GACtT,uDACA","debugId":null}},
    {"offset": {"line": 359, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Ahmad%20Alhraki/Desktop/moonflex/src/app/auth/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/auth/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/auth/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAqQ,GAClS,mCACA","debugId":null}},
    {"offset": {"line": 373, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}